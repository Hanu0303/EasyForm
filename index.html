<!DOCTYPE html>
<html>
<head>
<title>Page Title</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="jquery.mobile-1.3.2.min.css" />
<script src="js/phonegap-1.2.0.js"></script>
<script src="js/jquery-1.9.1.min.js"></script>
<script src="js/jquery.mobile-1.3.2.min.js"></script>

</head>
<body>

<div data-role="page">
  <div data-role="header" data-position="fixed" data-theme="b">
    <h1>Soccer Player</h1>
  </div>
  <div data-role="content">
	<div id="form_list_box">
		<ul id="SoccerPlayerList"></ul>
		<input type="button" id="add_form" value="ADD FORM" /> 
	</div>
	<div id="form_new_box" style="display:none">
		<button onclick="getPhoto(pictureSource.PHOTOLIBRARY);">ADD PHOTO</button>
		<img id="largeImage" width="100" src="" />
		<div>Name<input type="text" value="" id="new_name" /></div>
		<div>Club<input type="text" value="" id="new_club" /></div>
		<button id="add_form_save">ADD</button> 
	</div>
  </div>
</div>

<!--end of Soccer Player Page--->
</body>
<script type="text/javascript" charset="utf-8" src="cordova.js"></script>
<script type="text/javascript" charset="utf-8">
    //document.addEventListener("deviceready", onDeviceReady, false);
    var db = window.openDatabase("KODE", "1.0", "DB for EasyForm", 200000); //will create database Dummy_DB or open it
	db.transaction(CreateDB, errorCB, successCB);
    function CreateDB(tx) {
        tx.executeSql('CREATE TABLE IF NOT EXISTS KODE_EasyForm (id INTEGER PRIMARY KEY AUTOINCREMENT, Name TEXT NOT NULL, Club TEXT NOT NULL, Image TEXT NULL)');
    }
    function errorCB(err) {
        alert("Error processing SQL: "+err.code);
    }
    function successCB() {
        db.transaction(queryDB,errorCB);
    }
    function queryDB(tx){
        tx.executeSql('SELECT * FROM KODE_EasyForm',[],list_records,errorCB);
    }
    function list_records(tx,result){
		//$.mobile.showPageLoadingMsg(true);
        var len = result.rows.length;
		var htmlData = '';
		$("#SoccerPlayerList").html('');
		for (var i=0; i<len; i++){
			var row= result.rows.item(i);
			htmlData = '<li><a href="form.html?id='+row['id']+'"><h3 class="ui-li-heading">'+row['Name']+'</h3><p class="ui-li-desc">Club '+row['Club']+'</p><p class="ui-li-desc">Image: '+row['Image']+'</p></a></li>';
			$("#SoccerPlayerList").append(htmlData);
		}

    }
    function addrecord(tx) {
		tx.executeSql('INSERT INTO KODE_EasyForm(Name,Club,Image) VALUES ("'+$('#new_name').val()+'", "'+$('#new_club').val()+'","'+$('#largeImage').attr('src')+'")');
    }
	function successfully_added_form() {
		db.transaction(queryDB,errorCB);
		alert('Saved');
		$('#form_list_box').css('display','block');
		$('#form_new_box').css('display','none');
	}
	
	$('#add_form').click(function(){
		$('#form_list_box').css('display','none');
		$('#form_new_box').css('display','block');
	});
	$('#add_form_save').click(function(){
		db.transaction(addrecord, errorCB,successfully_added_form);
	});
</script>
</html>